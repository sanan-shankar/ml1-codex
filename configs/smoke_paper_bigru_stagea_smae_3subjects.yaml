{
  "experiment": {
    "name": "smoke_paper_bigru_stagea_smae_3subjects",
    "seed": 42,
    "output_root": "outputs/smoke",
    "device": "cpu"
  },
  "data": {
    "data_root": "/Users/sanan/Desktop/ML/my-ml1/files",
    "subjects": ["S001", "S002", "S003"],
    "channels": ["FC5","FC3","FC1","FCZ","FC2","FC4","FC6","C5","C3","C1","CZ","C2","C4","C6","CP5","CP3","CP1","CPZ","CP2","CP4","CP6","FZ","PZ"],
    "stage_channels": {
      "stage_a": ["FC3","FC1","FC2","FC4","C3","C1","C2","C4","CP3","CP1","CP2","CP4"],
      "stage_a_finetune_imagery": ["FC3","FC1","FC2","FC4","C3","C1","C2","C4","CP3","CP1","CP2","CP4"]
    },
    "sfreq": 160,
    "tmin": 0.5,
    "tmax": 4.0,
    "baseline_window_len": 561,
    "baseline_window_stride": 561,
    "bandpass": [8.0, 30.0],
    "notch": null,
    "reref": null,
    "csd": false,
    "rest_zscore": true,
    "euclidean_alignment": true,
    "cache": {"enabled": false, "dir": "outputs/cache", "version": "v3"}
  },
  "augmentation": {
    "enabled": true,
    "gaussian_noise_std": 0.005,
    "time_shift_max": 4,
    "amplitude_scale_min": 0.98,
    "amplitude_scale_max": 1.02
  },
  "augmentation_overrides": {
    "stage_a": {"time_shift_max": 0},
    "stage_a_finetune_imagery": {"time_shift_max": 0}
  },
  "model": {
    "type": "eegnet",
    "dropout": 0.35,
    "eegnet": {"F1": 8, "D": 2, "F2": 16, "kernel_length": 64, "sep_kernel_length": 16}
  },
  "model_overrides": {
    "stage_a": {
      "type": "cnn_bigru",
      "dropout": 0.30,
      "paper_cnn_gru": {
        "conv_filters": 24,
        "gru_hidden": 64,
        "bidirectional": true,
        "use_attention": true,
        "attn_hidden": 32,
        "fc_hidden": 32,
        "spatial_dropout": 0.25
      }
    },
    "stage_a_finetune_imagery": {
      "type": "cnn_bigru",
      "dropout": 0.30,
      "paper_cnn_gru": {
        "conv_filters": 24,
        "gru_hidden": 64,
        "bidirectional": true,
        "use_attention": true,
        "attn_hidden": 32,
        "fc_hidden": 32,
        "spatial_dropout": 0.25
      }
    }
  },
  "split": {
    "seed": 42,
    "n_train_pool": 2,
    "n_test": 1,
    "inner_val_count": 1,
    "path": null
  },
  "train": {
    "num_workers": 0,
    "batch_size": 32,
    "lr": 0.001,
    "weight_decay": 0.0001,
    "max_epochs": 2,
    "patience": 2,
    "min_delta": 0.0,
    "use_balanced_sampler": true,
    "weighted_loss": true,
    "stage_a": {"batch_size": 32, "lr": 0.001, "max_epochs": 2, "patience": 2, "sampler_strategy": "stage_a_runkind_label"},
    "stage_a_family_heads": {"enabled": false},
    "stage_b": {"batch_size": 32, "lr": 0.001, "max_epochs": 2, "patience": 2},
    "stage_b_family_heads": {"enabled": true},
    "fine_tune_imagery_stage_a": {"enabled": true, "init_from_base": true, "lr": 0.0005, "max_epochs": 1, "patience": 1, "batch_size": 32},
    "fine_tune_imagery": {"enabled": true, "init_from_base": true, "lr": 0.0005, "max_epochs": 1, "patience": 1, "batch_size": 32}
  },
  "eval": {
    "run_kinds": ["combined", "executed", "imagined"],
    "stage_b_task_type_masking": true,
    "calibrate_stage_a_thresholds": false,
    "stage_a_tta_time_shifts": [-8, 0, 8],
    "plots": {"psd": false, "erd_topomap": false, "learning_curves": true, "saliency_samples": 0}
  }
}

